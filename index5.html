<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Paribu Cineverse Ege Bölgesi</title>





<!-- Tell the browser to be responsive to screen width -->
<meta name="viewport" content="width=device-width, minimum-scale=1, maximum-scale=1" />

<!-- v4.0.0-alpha.6 -->
<link rel="stylesheet" href="dist/bootstrap/css/bootstrap.min.css">

<!-- Google Font -->
<link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700" rel="stylesheet">

<!-- Theme style -->
<link rel="stylesheet" href="dist/css/style.css">
<link rel="stylesheet" href="dist/css/font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="dist/css/et-line-font/et-line-font.css">
<link rel="stylesheet" href="dist/css/themify-icons/themify-icons.css">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->

</head>
<body class="hold-transition skin-blue sidebar-mini">  
<div class="wrapper boxed-wrapper">
  <!-- Left side column. contains the logo and sidebar -->
  <aside class="main-sidebar"> 
    <!-- sidebar: style can be found in sidebar.less -->
    <div class="sidebar"> 
      <!-- Sidebar user panel -->
      <div class="user-panel">
        <div class="image text-center"><img src="dist/img/paribulogo.jpeg" class="img-circle" alt="User Image"> </div>
        <div class="info">
          <p>Ege Bölge Yönetim</p>
          <a href="#"><i class="fa fa-cog"></i></a> <a href="#"><i class="fa fa-envelope-o"></i></a> <a href="#"><i class="fa fa-power-off"></i></a> </div>
      </div>
      
      <!-- sidebar menu: : style can be found in sidebar.less -->
      <ul class="sidebar-menu" data-widget="tree">
        <li class="header">ANA MENÜ</li>
        <li class="active treeview"> <a href="#"> <i class="fa fa-dashboard"></i> <span>Dashboard</span> <span class="pull-right-container"> <i class="fa fa-angle-left pull-right"></i> </span> </a>
          <ul class="treeview-menu">
            <li><a href="index.html">Anasayfa</a></li>
            <li><a href="index2.html">Notlar</a></li>
            <li><a href="index4.html">Gelir Grafiği</a></li>
            <li><a href="index4.html">Personel Veritabanı</a></li>
            <li class="active"><a href="index5.html">Gider Grafiği</a></li>
          </ul>
        </li>

          </ul>
        </li>
      </ul>
    </div>
    <!-- /.sidebar --> 
  </aside>
  
  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper"> 
    <!-- Content Header (Page header) -->
    <div class="content-header sty-one">
      <h1>6 Aylık Gider Grafiği</h1>
      <ol class="breadcrumb">
        <li><a href="#">Home</a></li>
        <li><i class="fa fa-angle-right"></i> 6 Aylık Gelir Grafiği</li>
      </ol>
    </div>
    
    <!-- Main content -->
    <div class="content"> 
        <label for="sinemaSecim">Şube Seçin:</label>
        <select id="sinemaSecim">
            <option value="1">Bodrum Midtown</option>
            <option value="2">Forum Bornova</option>
            <option value="3">İzmirpark</option>
            <option value="4">Hilltown</option>
            <option value="5">Konak Pier</option>
            <option value="6">Mavibahçe</option>
            <option value="7">Optimum</option>
            <option value="8">Park Afyon</option>
            <option value="9">Point Bornova</option>
        </select>
    

        <ul id="personnelList"></ul>

        <div id="sinemaTable"></div>


        
        <canvas id="barChartCanvas" width="400" height="200"></canvas>


        <label for="sinemaSecim">Şube Seçin:</label>
        <select id="sinemaSecim">
            <option value="1">Bodrum Midtown</option>
            <option value="2">Forum Bornova</option>
            <option value="3">İzmirpark</option>
            <option value="4">Hilltown</option>
            <option value="5">Konak Pier</option>
            <option value="6">Mavibahçe</option>
            <option value="7">Optimum</option>
            <option value="8">Park Afyon</option>
            <option value="9">Point Bornova</option>
        </select>

        <canvas id="altiAylikGiderGrafik" width="400" height="200"></canvas>


 </div>


      
      <!-- Small boxes (Stat box) -->
      <div class="row">
        <div class="col-lg-4">
          <div class="small-box bg-aqua">
            <div class="inner">
              <div class="text-left">
                <h2>En Çok Gider</h2>
                <h6>Kasım</h6>
              </div>
              <div class="text-right m-t-2">
                <h1><sup><i class="ti-arrow-up"></i></sup> 18900 TL</h1>
              </div>
              <div class="m-b-2"><span class="text-white"></span>
                <div class="progress bg-lightblue">
                  
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-lg-4">
          <div class="small-box bg-darkblue text-white">
            <div class="inner">
              <div class="text-left">
                <h2>En Az Gider </h2>
                <h6>Aralık</h6>
              </div>
              <div class="text-right m-t-2">
                <h1><sup><i class="ti-arrow-up"></i></sup> 6900 TL</h1>
              </div>
              <div class="m-b-2"><span class="text-white"></span>
                <div class="progress bg-lightblue">
                  
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-lg-4">
          <div class="small-box bg-orange">
            <div class="inner">
              <div class="text-left">
                <h2>En Tasarruflu İşletme</h2>
                <h6>En düşük ortalama gider</h6>
              </div>
              <div class="text-right m-t-2">
                <h1><sup><i class="ti-arrow-up"></i></sup> Mavibahçe</h1>
              </div>
              <div class="m-b-2"><span class="text-white"></span>
                <div class="progress bg-lightblue">
                
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- /.row --> 
      <!-- Main row -->


      
    <!-- /.content --> 
  </div>
  <!-- /.content-wrapper -->
  <footer class="main-footer">
    <div class="pull-right hidden-xs">Version 1.2</div>
    MARS SİNEMA SPORTİF TURİZM.</footer>
</div>
<!-- ./wrapper --> 

<!-- jQuery 3 --> 
<script src="dist/js/jquery.min.js"></script> 

<!-- v4.0.0-alpha.6 --> 
<script src="dist/bootstrap/js/bootstrap.min.js"></script> 

<!-- template --> 
<script src="dist/js/niche.js"></script> 

<!-- Chartjs JavaScript --> 
<script src="dist/plugins/chartjs/chart.min.js"></script>
<script src="dist/plugins/chartjs/chart-int.js"></script>


<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>


<!-- Chart Peity JavaScript --> 
<script src="dist/plugins/peity/jquery.peity.min.js"></script> 
<script src="dist/plugins/functions/jquery.peity.init.js"></script>







<script>

document.addEventListener('DOMContentLoaded', () => {
    const sinemaSecim = document.getElementById('sinemaSecim');
    const ctx = document.getElementById('altiAylikGelirGrafik').getContext('2d');
    let chart;

    function updateChart(sinemaID) {
        fetch(`/kar-zarar/${sinemaID}`)
            .then(response => response.json())
            .then(data => {
                const labels = data.map(item => `Ay ${item.ay}`);
                const values = data.map(item => item.toplamGelir);

                if (chart) {
                    chart.data.labels = labels;
                    chart.data.datasets[0].data = values;
                    chart.update();
                } else {
                    chart = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels,
                            datasets: [{
                                label: 'Aylık Gelir',
                                data: values,
                                borderColor: 'rgba(75, 192, 192, 1)',
                                borderWidth: 2,
                                fill: false,
                            }],
                        },
                        options: {
                            responsive: true,
                            scales: {
                                y: { beginAtZero: true },
                            },
                        },
                    });
                }
            })
            .catch(error => console.error('API Hatası:', error));
    }

    sinemaSecim.addEventListener('change', (event) => {
        updateChart(event.target.value);
    });

    updateChart(sinemaSecim.value); // Varsayılan şube için grafik yükle
});


</script>

<script>

// Global barChart değişkenini tanımlayın
let barChart;

$(function () {
    "use strict";

    const sinemaSelect = document.getElementById('sinemaSelect');
    const ctx = document.getElementById('barChartCanvas').getContext('2d');

    // Varsayılan şube gelirlerini yükle
    updateBarChart(sinemaSelect.value);

    // Şube değiştirildiğinde grafiği güncelle
    sinemaSelect.addEventListener('change', (event) => {
        updateBarChart(event.target.value);
    });
});

// Verileri almak ve grafiği güncellemek için bir fonksiyon tanımlayalım
function updateBarChart(sinemaID) {
    fetch(`/sinemalar-gelirleri/${sinemaID}`)
        .then(response => response.json())
        .then(data => {
            // Gelen verileri Chart.js'e uygun formata dönüştürelim
            const labels = data.map(item => `Ay ${item.ay}`);
            const gelirData = data.map(item => item.gelir);

            // Grafiği güncelle
            if (barChart) {
                barChart.data.labels = labels;
                barChart.data.datasets[0].data = gelirData;
                barChart.update();
            } else {
                const ctx = document.getElementById('barChartCanvas').getContext('2d');
                barChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [
                            {
                                label: 'Aylık Gelirler',
                                backgroundColor: 'rgba(54, 162, 235, 0.6)',
                                borderColor: 'rgba(54, 162, 235, 1)',
                                data: gelirData,
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            x: {
                                title: {
                                    display: true,
                                    text: 'Aylar'
                                }
                            },
                            y: {
                                title: {
                                    display: true,
                                    text: 'Gelir (TL)'
                                },
                                beginAtZero: true
                            }
                        },
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            }
                        }
                    }
                });
            }
        })
        .catch(error => console.error('API Hatası:', error));
}





</script>


<script src="/giderler.js"></script>



<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.7/js/tether.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.11.6/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="dist/js/niche.js"></script>
<script src="dist/plugins/chartjs/chart.min.js"></script>


</body>
</html>
